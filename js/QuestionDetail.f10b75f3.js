(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["QuestionDetail"],{"444d":function(e,t,r){"use strict";r.r(t);r("a15b");var n=r("7a23"),c=Object(n["withScopeId"])("data-v-ecccab5a");Object(n["pushScopeId"])("data-v-ecccab5a");var o={class:"question-detail"},a={class:"left"},i={class:"question"},s={class:"title"},u={class:"info"},l={class:"tag"},d={class:"answer"},b={class:"h2-title"},p={class:"list"},j={class:"info"},m={key:0,class:"question-author"},O={key:0,class:"option"},f=Object(n["createTextVNode"])(" 复制 "),v=Object(n["createTextVNode"])("删除"),g=Object(n["createVNode"])("div",{class:"h2-title",id:"my-answer-title"},"撰写回答",-1),w={class:"my-answer"},h={class:"submit-btn"},V=Object(n["createTextVNode"])(" 提交回答 "),k={class:"right"},N={class:"box"},q=Object(n["createVNode"])("div",{class:"title"},"相关文章",-1),y={key:0,class:"article-list"},A={class:"box"},x=Object(n["createVNode"])("div",{class:"title"},"添加相关文章",-1),C={class:"form"},I=Object(n["createTextVNode"])("提交");Object(n["popScopeId"])();var B=c((function(e,t,r,B,S,U){var D=Object(n["resolveComponent"])("v-md-editor"),R=Object(n["resolveComponent"])("el-empty"),T=Object(n["resolveComponent"])("el-button"),F=Object(n["resolveComponent"])("el-popconfirm"),L=Object(n["resolveComponent"])("el-input"),_=Object(n["resolveComponent"])("el-form-item"),P=Object(n["resolveComponent"])("el-form");return Object(n["openBlock"])(),Object(n["createBlock"])("div",o,[Object(n["createVNode"])("div",a,[Object(n["createVNode"])("div",i,[Object(n["createVNode"])("div",s,Object(n["toDisplayString"])(e.questionTitle),1),Object(n["createVNode"])("div",u,[Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(e.questionAuthor),1),Object(n["createVNode"])("div",null,"发布于："+Object(n["toDisplayString"])(e.questionDate),1)]),Object(n["createVNode"])("div",l,"Tag："+Object(n["toDisplayString"])(e.questionTag.join("，")),1),Object(n["createVNode"])(D,{class:"cont",modelValue:e.questionContent,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.questionContent=t}),mode:"preview"},null,8,["modelValue"])]),Object(n["createVNode"])("div",d,[Object(n["createVNode"])("div",b,Object(n["toDisplayString"])(e.answerList.length)+"个回答",1),Object(n["createVNode"])("div",p,[e.answerList.length?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(R,{key:0,class:"item",description:"暂无回答"})),(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.answerList,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:"item",key:t.objectId},[Object(n["createVNode"])("div",j,[Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(t.author),1),e.questionAuthor==t.author?(Object(n["openBlock"])(),Object(n["createBlock"])("div",m," 题主 ")):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])("div",null,"发布于："+Object(n["toDisplayString"])(e.formatTimefn(t.createdAt)),1)]),Object(n["createVNode"])(D,{modelValue:t.content,"onUpdate:modelValue":function(e){return t.content=e},mode:"preview"},null,8,["modelValue","onUpdate:modelValue"]),e.LoginUser==t.author?(Object(n["openBlock"])(),Object(n["createBlock"])("div",O,[Object(n["createVNode"])(T,{type:"text",onClick:function(r){return e.showUpdateAnswer(t.content)}},{default:c((function(){return[f]})),_:2},1032,["onClick"]),Object(n["createVNode"])(F,{onConfirm:function(r){return e.deleteAnswer(t.objectId)},title:"确认删除吗？"},{reference:c((function(){return[Object(n["createVNode"])(T,{type:"text"},{default:c((function(){return[v]})),_:1})]})),_:2},1032,["onConfirm"])])):Object(n["createCommentVNode"])("",!0)])})),128))]),g,Object(n["createVNode"])("div",w,[Object(n["createVNode"])(D,{modelValue:e.editorUserAnswer,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.editorUserAnswer=t}),height:"280px",onChange:e.handleChange,"right-toolbar":"fullscreen","left-toolbar":"undo redo clear | h bold italic strikethrough quote emoji | tip ul ol table hr | todo-list link image code "},null,8,["modelValue","onChange"]),Object(n["createVNode"])("div",h,[Object(n["createVNode"])(T,{type:"primary",onClick:e.submitAnswer},{default:c((function(){return[V]})),_:1},8,["onClick"])])])])]),Object(n["createVNode"])("div",k,[Object(n["createVNode"])("div",N,[q,e.articleList.length?(Object(n["openBlock"])(),Object(n["createBlock"])("div",y,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.articleList,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{onClick:function(r){return e.openUrl(t.url)},class:"item",key:t.objectId},Object(n["toDisplayString"])(t.title),9,["onClick"])})),128))])):(Object(n["openBlock"])(),Object(n["createBlock"])(R,{key:1,description:"暂无相关文章"}))]),Object(n["createVNode"])("div",A,[x,Object(n["createVNode"])("div",C,[Object(n["createVNode"])(P,{model:e.articleForm,"label-width":"60px","label-suffix":"："},{default:c((function(){return[Object(n["createVNode"])(_,{label:"标题"},{default:c((function(){return[Object(n["createVNode"])(L,{modelValue:e.articleForm.title,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.articleForm.title=t})},null,8,["modelValue"])]})),_:1}),Object(n["createVNode"])(_,{label:"链接"},{default:c((function(){return[Object(n["createVNode"])(L,{modelValue:e.articleForm.url,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.articleForm.url=t})},null,8,["modelValue"])]})),_:1}),Object(n["createVNode"])(_,{class:"submit-btn"},{default:c((function(){return[Object(n["createVNode"])(T,{type:"primary",onClick:e.addArticle},{default:c((function(){return[I]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])])])])])})),S=r("5530"),U=r("1da1"),D=(r("99af"),r("b64b"),r("96cf"),r("79f6")),R=r("dbe5"),T=r("6c02"),F=r("3fd4");function L(e,t){var r=t||"1",n=new Date(e),c=new Date,o=n.getFullYear(),a=n.getMonth()+1,i=n.getDate(),s=n.getHours(),u=n.getMinutes(),l=n.getSeconds(),d=c.getFullYear(),b=c.getMonth()+1,p=c.getDate(),j=c.getHours(),m=c.getMinutes(),O=c.getSeconds();return"2"===r?"".concat(o,"年").concat(a,"月").concat(i,"号 ").concat(s,"点").concat(u,"分"):d-o>1?d-o+"年前"+a+"月"+i+"号"+s+"点":d-o>0?"去年"+a+"月"+i+"号"+s+"点":b-a>0?"今年"+a+"月"+i+"号"+s+"点":p-i>1?p-i+"天前"+s+"点":p-i>0?"昨天"+s+"点":j-s>0?j-s+"小时前":m-u>0?m-u+"分钟前":O-l>0?O-l+"秒前":"刚刚"}var _=Object(n["defineComponent"])({setup:function(){var e=L,t=Object(n["inject"])("lodash"),r=Object(n["reactive"])({LoginUser:localStorage.getItem("userName")||"",questionId:"",questionTitle:"",questionContent:"",questionAuthor:"",questionDate:"",questionTag:[],userAnswer:"",editorUserAnswer:"",answerList:[],articleList:[],articleForm:{title:"",url:""}}),c=Object(n["toRefs"])(r),o=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{objectId:r.questionId}}},e.next=3,Object(R["a"])("get",D["a"].questionAPI,t);case 3:if(n=e.sent,n.results.length){e.next=6;break}return e.abrupt("return",F["b"].error("查询题目信息出错，请查看其他题目"));case 6:n=n.results[0],r.questionTitle=n.title,r.questionContent=n.content,r.questionAuthor=n.author,r.questionDate=n.createdAt.substr(0,10),r.questionTag=n.tag,c=document.querySelector('meta[name="description"]'),c.setAttribute("content",r.questionTitle),console.log(c);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{questionId:r.questionId}}},e.next=3,Object(R["a"])("get",D["a"].questionArticleAPI,t);case 3:n=e.sent,r.articleList=n.results;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{questionId:r.questionId}}},e.next=3,Object(R["a"])("get",D["a"].answerAPI,t);case 3:n=e.sent,r.answerList=n.results;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(e){window.open(e)},u=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n,c,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.articleForm,n=t.title,c=t.url,o=r.questionId,n){e.next=4;break}return e.abrupt("return",F["b"].error("请输入文章标题"));case 4:if(c){e.next=6;break}return e.abrupt("return",F["b"].error("请输入文章链接"));case 6:return e.next=8,Object(R["a"])("post",D["a"].questionArticleAPI,{title:n,url:c,questionId:o});case 8:if(i=e.sent,!i.objectId){e.next=16;break}F["b"].success("提交成功"),r.articleForm.title="",r.articleForm.url="",a(),e.next=17;break;case 16:return e.abrupt("return",F["b"].error("提交出错，请稍后再试"));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n["onMounted"])((function(){var e=Object(T["c"])();r.questionId=e.query.id,o(),i(),a()}));var l=t.debounce((function(e){r.userAnswer=e}),1e3),d=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(localStorage.getItem("userName")){e.next=2;break}return e.abrupt("return",F["b"].error("未登录不能回答题目"));case 2:if(t=r.userAnswer,n=r.questionId,t.length){e.next=5;break}return e.abrupt("return",F["b"].error("回答内容不能为空"));case 5:return e.next=7,Object(R["a"])("post",D["a"].answerAPI,{content:t,questionId:n,author:localStorage.getItem("userName")});case 7:c=e.sent,c.objectId?(F["b"].success("发布成功"),r.userAnswer="",r.editorUserAnswer="",i()):F["b"].error("发布失败，请稍后再试");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(R["a"])("delete","".concat(D["a"].answerAPI,"/").concat(t));case 2:r=e.sent,0===Object.keys(r).length?(F["b"].success("删除成功"),i()):F["b"].success("删除失败");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.editorUserAnswer=t,F["b"].success("回答信息已复制到答题区域，可编辑后再次提交"),n=document.querySelector("#my-answer-title"),window.scrollTo({top:n.getBoundingClientRect().top+document.documentElement.scrollTop-80,behavior:"smooth"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S["a"])(Object(S["a"])({},c),{},{handleChange:l,submitAnswer:d,formatTimefn:e,openUrl:s,addArticle:u,deleteAnswer:b,showUpdateAnswer:p})}});r("a4d4");_.render=B,_.__scopeId="data-v-ecccab5a";t["default"]=_},"94ad":function(e,t,r){},a15b:function(e,t,r){"use strict";var n=r("23e7"),c=r("44ad"),o=r("fc6a"),a=r("a640"),i=[].join,s=c!=Object,u=a("join",",");n({target:"Array",proto:!0,forced:s||!u},{join:function(e){return i.call(o(this),void 0===e?",":e)}})},a4d4:function(e,t,r){"use strict";r("94ad")}}]);