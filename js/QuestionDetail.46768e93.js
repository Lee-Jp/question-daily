(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["QuestionDetail"],{"0ba0":function(e,t,r){},"444d":function(e,t,r){"use strict";r.r(t);r("a15b");var n=r("7a23"),c=Object(n["withScopeId"])("data-v-25dcf5f0");Object(n["pushScopeId"])("data-v-25dcf5f0");var o={class:"question-detail"},a={class:"left"},i={class:"question"},u={class:"title"},s={class:"info"},l={class:"tag"},d={key:0,class:"option"},b=Object(n["createTextVNode"])(" 编辑 "),p=Object(n["createTextVNode"])("删除"),j={class:"answer"},f={class:"h2-title"},O={class:"list"},m={class:"info"},v={key:0,class:"question-author"},h={key:0,class:"option"},g=Object(n["createTextVNode"])(" 复制 "),w=Object(n["createTextVNode"])("删除"),V=Object(n["createVNode"])("div",{class:"h2-title",id:"my-answer-title"},"撰写回答",-1),k={class:"my-answer"},N={class:"submit-btn"},q=Object(n["createTextVNode"])(" 提交回答 "),y={class:"right"},x={class:"box"},A=Object(n["createVNode"])("div",{class:"title"},"相关文章",-1),C={key:0,class:"article-list"},I={class:"box"},B=Object(n["createVNode"])("div",{class:"title"},"添加相关文章",-1),T={class:"form"},R=Object(n["createTextVNode"])("提交");Object(n["popScopeId"])();var S=c((function(e,t,r,S,U,D){var L=Object(n["resolveComponent"])("v-md-editor"),_=Object(n["resolveComponent"])("el-button"),F=Object(n["resolveComponent"])("el-popconfirm"),P=Object(n["resolveComponent"])("el-empty"),Q=Object(n["resolveComponent"])("el-input"),M=Object(n["resolveComponent"])("el-form-item"),H=Object(n["resolveComponent"])("el-form");return Object(n["openBlock"])(),Object(n["createBlock"])("div",o,[Object(n["createVNode"])("div",a,[Object(n["createVNode"])("div",i,[Object(n["createVNode"])("div",u,Object(n["toDisplayString"])(e.questionTitle),1),Object(n["createVNode"])("div",s,[Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(e.questionAuthor),1),Object(n["createVNode"])("div",null,"发布于："+Object(n["toDisplayString"])(e.questionDate),1)]),Object(n["createVNode"])("div",l,"Tag："+Object(n["toDisplayString"])(e.questionTag.join("，")),1),Object(n["createVNode"])(L,{class:"cont",modelValue:e.questionContent,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.questionContent=t}),mode:"preview"},null,8,["modelValue"]),e.LoginUser==e.questionAuthor?(Object(n["openBlock"])(),Object(n["createBlock"])("div",d,[Object(n["createVNode"])(_,{type:"text",onClick:t[2]||(t[2]=function(t){return e.editQuestion()})},{default:c((function(){return[b]})),_:1}),Object(n["createVNode"])(F,{onConfirm:t[3]||(t[3]=function(t){return e.deleteQuestion()}),title:"确认删除该题目吗？"},{reference:c((function(){return[Object(n["createVNode"])(_,{type:"text"},{default:c((function(){return[p]})),_:1})]})),_:1})])):Object(n["createCommentVNode"])("",!0)]),Object(n["createVNode"])("div",j,[Object(n["createVNode"])("div",f,Object(n["toDisplayString"])(e.answerList.length)+"个回答",1),Object(n["createVNode"])("div",O,[e.answerList.length?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(P,{key:0,class:"item",description:"暂无回答"})),(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.answerList,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:"item",key:t.objectId},[Object(n["createVNode"])("div",m,[Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(t.author),1),e.questionAuthor==t.author?(Object(n["openBlock"])(),Object(n["createBlock"])("div",v," 题主 ")):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])("div",null,"发布于："+Object(n["toDisplayString"])(e.formatTimefn(t.createdAt)),1)]),Object(n["createVNode"])(L,{modelValue:t.content,"onUpdate:modelValue":function(e){return t.content=e},mode:"preview"},null,8,["modelValue","onUpdate:modelValue"]),e.LoginUser==t.author?(Object(n["openBlock"])(),Object(n["createBlock"])("div",h,[Object(n["createVNode"])(_,{type:"text",onClick:function(r){return e.showUpdateAnswer(t.content)}},{default:c((function(){return[g]})),_:2},1032,["onClick"]),Object(n["createVNode"])(F,{onConfirm:function(r){return e.deleteAnswer(t.objectId)},title:"确认删除吗？"},{reference:c((function(){return[Object(n["createVNode"])(_,{type:"text"},{default:c((function(){return[w]})),_:1})]})),_:2},1032,["onConfirm"])])):Object(n["createCommentVNode"])("",!0)])})),128))]),V,Object(n["createVNode"])("div",k,[Object(n["createVNode"])(L,{modelValue:e.editorUserAnswer,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.editorUserAnswer=t}),height:"280px",onChange:e.handleChange,"right-toolbar":"fullscreen","left-toolbar":"undo redo clear | h bold italic strikethrough quote emoji | tip ul ol table hr | todo-list link image code "},null,8,["modelValue","onChange"]),Object(n["createVNode"])("div",N,[Object(n["createVNode"])(_,{type:"primary",onClick:e.submitAnswer},{default:c((function(){return[q]})),_:1},8,["onClick"])])])])]),Object(n["createVNode"])("div",y,[Object(n["createVNode"])("div",x,[A,e.articleList.length?(Object(n["openBlock"])(),Object(n["createBlock"])("div",C,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.articleList,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{onClick:function(r){return e.openUrl(t.url)},class:"item",key:t.objectId},Object(n["toDisplayString"])(t.title),9,["onClick"])})),128))])):(Object(n["openBlock"])(),Object(n["createBlock"])(P,{key:1,description:"暂无相关文章"}))]),Object(n["createVNode"])("div",I,[B,Object(n["createVNode"])("div",T,[Object(n["createVNode"])(H,{model:e.articleForm,"label-width":"60px","label-suffix":"："},{default:c((function(){return[Object(n["createVNode"])(M,{label:"标题"},{default:c((function(){return[Object(n["createVNode"])(Q,{modelValue:e.articleForm.title,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.articleForm.title=t})},null,8,["modelValue"])]})),_:1}),Object(n["createVNode"])(M,{label:"链接"},{default:c((function(){return[Object(n["createVNode"])(Q,{modelValue:e.articleForm.url,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.articleForm.url=t})},null,8,["modelValue"])]})),_:1}),Object(n["createVNode"])(M,{class:"submit-btn"},{default:c((function(){return[Object(n["createVNode"])(_,{type:"primary",onClick:e.addArticle},{default:c((function(){return[R]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])])])])])})),U=r("5530"),D=r("1da1"),L=(r("99af"),r("b64b"),r("96cf"),r("79f6")),_=r("dbe5"),F=r("6c02"),P=r("3fd4");function Q(e,t){var r=t||"1",n=new Date(e),c=new Date,o=n.getFullYear(),a=n.getMonth()+1,i=n.getDate(),u=n.getHours(),s=n.getMinutes(),l=n.getSeconds(),d=c.getFullYear(),b=c.getMonth()+1,p=c.getDate(),j=c.getHours(),f=c.getMinutes(),O=c.getSeconds();return"2"===r?"".concat(o,"年").concat(a,"月").concat(i,"号 ").concat(u,"点").concat(s,"分"):d-o>1?d-o+"年前"+a+"月"+i+"号"+u+"点":d-o>0?"去年"+a+"月"+i+"号"+u+"点":b-a>0?"今年"+a+"月"+i+"号"+u+"点":p-i>1?p-i+"天前"+u+"点":p-i>0?"昨天"+u+"点":j-u>0?j-u+"小时前":f-s>0?f-s+"分钟前":O-l>0?O-l+"秒前":"刚刚"}var M=Object(n["defineComponent"])({setup:function(){var e=Q,t=Object(n["inject"])("lodash"),r=Object(n["reactive"])({LoginUser:localStorage.getItem("userName")||"",questionId:"",questionTitle:"",questionContent:"",questionAuthor:"",questionDate:"",questionTag:[],userAnswer:"",editorUserAnswer:"",answerList:[],articleList:[],articleForm:{title:"",url:""}}),c=Object(F["d"])(),o=Object(n["toRefs"])(r),a=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{objectId:r.questionId}}},e.next=3,Object(_["a"])("get",L["a"].questionAPI,t);case 3:if(n=e.sent,n.results.length){e.next=6;break}return e.abrupt("return",P["b"].error("查询题目信息出错，请查看其他题目"));case 6:n=n.results[0],r.questionTitle=n.title,r.questionContent=n.content,r.questionAuthor=n.author,r.questionDate=n.createdAt.substr(0,10),r.questionTag=n.tag,c=document.querySelector('meta[name="description"]'),c.setAttribute("content",r.questionTitle),console.log(c);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{questionId:r.questionId}}},e.next=3,Object(_["a"])("get",L["a"].questionArticleAPI,t);case 3:n=e.sent,r.articleList=n.results;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={params:{where:{questionId:r.questionId}}},e.next=3,Object(_["a"])("get",L["a"].answerAPI,t);case 3:n=e.sent,r.answerList=n.results;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(e){window.open(e)},l=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n,c,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.articleForm,n=t.title,c=t.url,o=r.questionId,n){e.next=4;break}return e.abrupt("return",P["b"].error("请输入文章标题"));case 4:if(c){e.next=6;break}return e.abrupt("return",P["b"].error("请输入文章链接"));case 6:return e.next=8,Object(_["a"])("post",L["a"].questionArticleAPI,{title:n,url:c,questionId:o});case 8:if(a=e.sent,!a.objectId){e.next=16;break}P["b"].success("提交成功"),r.articleForm.title="",r.articleForm.url="",i(),e.next=17;break;case 16:return e.abrupt("return",P["b"].error("提交出错，请稍后再试"));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n["onMounted"])((function(){var e=Object(F["c"])();r.questionId=e.query.id,a(),u(),i()}));var d=t.debounce((function(e){r.userAnswer=e}),1e3),b=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(localStorage.getItem("userName")){e.next=2;break}return e.abrupt("return",P["b"].error("未登录不能回答题目"));case 2:if(t=r.userAnswer,n=r.questionId,t.length){e.next=5;break}return e.abrupt("return",P["b"].error("回答内容不能为空"));case 5:return e.next=7,Object(_["a"])("post",L["a"].answerAPI,{content:t,questionId:n,author:localStorage.getItem("userName")});case 7:c=e.sent,c.objectId?(P["b"].success("发布成功"),r.userAnswer="",r.editorUserAnswer="",u()):P["b"].error("发布失败，请稍后再试");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){c.push({path:"/setQuestion",query:{id:r.questionId}})},j=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.questionId,e.next=3,Object(_["a"])("delete","".concat(L["a"].questionAPI,"/").concat(t));case 3:n=e.sent,0===Object.keys(n).length?(P["b"].success("删除成功"),setTimeout((function(){c.push({path:"/"})}),800)):P["b"].success("删除失败");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(_["a"])("delete","".concat(L["a"].answerAPI,"/").concat(t));case 2:r=e.sent,0===Object.keys(r).length?(P["b"].success("删除成功"),u()):P["b"].success("删除失败");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(D["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.editorUserAnswer=t,P["b"].success("回答信息已复制到答题区域，可编辑后再次提交"),n=document.querySelector("#my-answer-title"),window.scrollTo({top:n.getBoundingClientRect().top+document.documentElement.scrollTop-80,behavior:"smooth"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(U["a"])(Object(U["a"])({},o),{},{handleChange:d,submitAnswer:b,formatTimefn:e,openUrl:s,addArticle:l,editQuestion:p,deleteQuestion:j,deleteAnswer:f,showUpdateAnswer:O})}});r("7b1c");M.render=S,M.__scopeId="data-v-25dcf5f0";t["default"]=M},"7b1c":function(e,t,r){"use strict";r("0ba0")},a15b:function(e,t,r){"use strict";var n=r("23e7"),c=r("44ad"),o=r("fc6a"),a=r("a640"),i=[].join,u=c!=Object,s=a("join",",");n({target:"Array",proto:!0,forced:u||!s},{join:function(e){return i.call(o(this),void 0===e?",":e)}})}}]);